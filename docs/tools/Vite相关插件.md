---
id: vite-plugin
slug: /vite-plugin
title: Viteç›¸å…³æ’ä»¶
date: 2022-04-10
authors: kuizuo
tags: [vue, vite]
toc_max_heading_level: 2
---

è®°å½•ä¸‹æ—¥å¸¸ä½¿ç”¨ Vite çš„ä¸€äº›ç›¸å…³æ’ä»¶ã€‚

<!-- truncate -->

## [unplugin-auto-import](https://github.com/antfu/unplugin-auto-import)

**è‡ªåŠ¨å¯¼å…¥ vue3 ç›¸å…³æ–¹æ³•ï¼Œæ”¯æŒ`vue`, `vue-router`, `vue-i18n`, `@vueuse/head`, `@vueuse/core`ç­‰è‡ªåŠ¨å¼•å…¥**

æ•ˆæœ

```javascript
// å¼•å…¥å‰
import { ref, computed } from 'vue'
const count = ref(0)
const doubled = computed(() => count.value * 2)

//å¼•å…¥å
const count = ref(0)
const doubled = computed(() => count.value * 2)

// å¼•å…¥å‰
import { useState } from 'react'
export function Counter() {
  const [count, setCount] = useState(0)
  return <div>{count}</div>
}

//å¼•å…¥å
export function Counter() {
  const [count, setCount] = useState(0)
  return <div>{count}</div>
}
```

å®‰è£…

```sh
npm i -D unplugin-auto-import
```

[å®Œæ•´é…ç½®](https://github.com/antfu/unplugin-auto-import#configuration)

```javascript title="vite.config.js"
import { defineConfig } from 'vite'
import AutoImport from 'unplugin-auto-import/vite'

export default defineConfig({
  plugins: [
    AutoImport({
      imports: ['vue', 'vue-router', 'vue-i18n', '@vueuse/head', '@vueuse/core'],
      dts: 'src/auto-import.d.ts',
      // å¯ä»¥é€‰æ‹©auto-import.d.tsç”Ÿæˆçš„ä½ç½®ï¼ˆé»˜è®¤æ ¹ç›®å½•ï¼‰ï¼Œå»ºè®®è®¾ç½®ä¸º'src/auto-import.d.ts'
    }),
  ],
})
```

åŸç†: è‡ªåŠ¨ç”Ÿæˆ auto-imports.d.ts æ–‡ä»¶ç”¨äºä»£ç æç¤ºï¼Œå¦‚ä¸‹

```typescript title="auto-imports.d.ts"
// Generated by 'unplugin-auto-import'
// We suggest you to commit this file into source control
declare global {
  const ref: typeof import('vue')['ref']
  const reactive: typeof import('vue')['reactive']
  const computed: typeof import('vue')['computed']
  const createApp: typeof import('vue')['createApp']
  const watch: typeof import('vue')['watch']
  const customRef: typeof import('vue')['customRef']
  const defineAsyncComponent: typeof import('vue')['defineAsyncComponent']
}
export {}
```

:::caution

æ³¨æ„ï¼Œç”±äºæ²¡æœ‰å±€éƒ¨å¯¼å…¥ï¼Œåœ¨ä»£ç è·³è½¬æŸ¥çœ‹æ—¶ï¼Œå°±ä¼šè·³è½¬åˆ° auto-imports.d.ts æ–‡ä»¶ï¼Œç„¶åå†è·³è½¬åˆ°åŸå®šä¹‰ä½ç½®ã€‚

:::

### å“åº”å¼è¯­æ³•ç³–

[Reactivity Transform | Vue.js (vuejs.org)](https://vuejs.org/guide/extras/reactivity-transform.html)

ä½¿ç”¨$ref åœ¨ä½¿ç”¨æ—¶ï¼Œæ— éœ€.valueã€‚æ¼”ç¤ºå¦‚ä¸‹

```javascript
import { $ref, $$ } from 'vue/macros' // $refæ˜¯vue/macrosåŒ…ä¸‹çš„

// bind ref as a variable
let count = $ref(0)

// assignments are reactive
count++

// get the actual ref
console.log($$(count)) // { value: 1 }
```

- å¯ä»¥ç”¨`$()`æ¥è§£æ„å“åº”å¼å¯¹è±¡ï¼Œè¿™æ ·å°±ä¸ç”¨å†™`.value`
- å¯ä»¥ç”¨`$$()`æ¥è·å–åŸæœ‰çš„å“åº”å¼å¯¹è±¡

åœ¨ vite.config.ts æ–‡ä»¶é‡Œï¼ŒåŠ ä¸Š`reactivityTransform: true`

```javascript title="vite.config.js"
plugins: [
  vue({
    reactivityTransform: true,
  }),
]
```

å¯ä»¥ä½¿ç”¨ unplugin-auto-import ä¸­çš„å¯¼å…¥`vue/macros`æ— éœ€ import å¯¼å…¥ã€‚

```javascript title="vite.config.js"
AutoImport({
  imports: ['vue/macros'],
  dts: true,
})
```

## [unplugin-vue-components](https://github.com/antfu/unplugin-vue-components)

**è‡ªåŠ¨å¯¼å…¥ UI åº“ï¼ŒæŒ‰éœ€å¯¼å…¥ã€‚å¾ˆå¤šç»„ä»¶åº“éƒ½æ¨èè¿™ç§æ–¹å¼å¯¼å…¥ä¾‹å¦‚ Element Plus ã€Ant Design Vue**

å®‰è£…

```sh
npm install unplugin-vue-components -D
```

```javascript title="vite.config.js"
import { defineConfig } from 'vite'
import Components from 'unplugin-vue-components/vite'
import {
  ElementPlusResolver,
  AntDesignVueResolver,
  VantResolver,
  HeadlessUiResolver,
  ElementUiResolver
} from 'unplugin-vue-components/resolvers'

export default defineConfig({
  plugins: [
    Components({
      // uiåº“è§£æå™¨ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰
      resolvers: [
        ElementPlusResolver(),
        AntDesignVueResolver(),
        VantResolver(),
        HeadlessUiResolver(),
        ElementUiResolver()
      ]
    })
  ]
```

æ’ä»¶ä¼šç”Ÿæˆä¸€ä¸ª ui åº“ç»„ä»¶ä»¥åŠæŒ‡ä»¤è·¯å¾„ components.d.ts æ–‡ä»¶ï¼Œå¦‚ä¸‹

```typescript title="components.d.ts"
// generated by unplugin-vue-components
// We suggest you to commit this file into source control
// Read more: https://github.com/vuejs/vue-next/pull/3399

declare module 'vue' {
  export interface GlobalComponents {
    ElAside: typeof import('element-plus/es')['ElAside']
    ElButton: typeof import('element-plus/es')['ElButton']
    ElContainer: typeof import('element-plus/es')['ElContainer']
    ElHeader: typeof import('element-plus/es')['ElHeader']
    ElIcon: typeof import('element-plus/es')['ElIcon']
    ElMain: typeof import('element-plus/es')['ElMain']
  }
}

export {}
```

åªè¦ä½ ç”¨è¿‡çš„ç»„ä»¶éƒ½ä¼šè‡ªåŠ¨å¯¼å…¥ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å¯¼å…¥è‡ªå·±çš„ç»„ä»¶ã€‚

```javascript title="vite.config.js"
import { defineConfig } from 'vite'
import Components from 'unplugin-vue-components/vite'

export default defineConfig({
  plugins: [
    Components({
      // æŒ‡å®šç»„ä»¶ä½ç½®ï¼Œé»˜è®¤æ˜¯src/components
      dirs: ['src/components'],
      extensions: ['vue'],
      // é…ç½®æ–‡ä»¶ç”Ÿæˆä½ç½®
      dts: 'src/components.d.ts',
    }),
  ],
})
```

## [unplugin-vue-define-options/vite](https://github.com/sxzz/unplugin-vue-define-options)

**script setup è¯­æ³•ç³–é€šè¿‡ defineOptions å®šä¹‰ç»„ä»¶ nameã€inheritAttrsã€propsã€emits**

å®‰è£…

```sh
npm i unplugin-vue-define-options
```

```javascript title="vite.config.js"
import { defineConfig } from 'vite'
import DefineOptions from 'unplugin-vue-define-options/vite'
import vue from '@vitejs/plugin-vue'

export default defineConfig({
  plugins: [vue(), DefineOptions()],
})
```

åœ¨`tsconfig.json`è®¾ç½® typesï¼Œå¦‚ä¸‹æ‰€ç¤º:

```json
{
  "compilerOptions": {
    "types": ["unplugin-vue-define-options"]
  }
}
```

ä¸ç„¶åœ¨ ts é¡¹ç›®ä¸­ä¼šæç¤º **æ‰¾ä¸åˆ°åç§°â€œdefineOptionsâ€**ï¼Œå…·ä½“ä½¿ç”¨å¦‚ä¸‹

```vue
<script setup lang="ts">
import { useSlots } from 'vue'
defineOptions({
  name: 'Foo',
  inheritAttrs: false,
  props: {
    msg: { type: String, default: 'bar' },
  },
  emits: ['change', 'update'],
})
const slots = useSlots()
</script>
```

è¾“å‡º

```vue
<script lang="ts">
export default {
  name: 'Foo',
  inheritAttrs: false,
  props: {
    msg: { type: String, default: 'bar' },
  },
  emits: ['change', 'update'],
}
</script>

<script setup>
const slots = useSlots()
</script>
```

å¦‚æœåªæ˜¯æƒ³**å•çº¯çš„è®¾ç½®ç»„ä»¶å**çš„è¯ï¼Œè¿™ä¸ªæ’ä»¶ [vite-plugin-vue-setup-extend](https://github.com/vbenjs/vite-plugin-vue-setup-extend) å¯èƒ½æ›´é€‚åˆï¼Œåªéœ€è¦åœ¨ script ä¸­æ·»åŠ ä¸€ä¸ª name å±æ€§å³å¯ã€‚

```vue
<template>
  <div>hello world {{ a }}</div>
</template>

<script lang="ts" setup name="App">
const a = 1
</script>
```

## [vite-plugin-mock](https://github.com/vbenjs/vite-plugin-mock)

**æä¾›æœ¬åœ°å’Œç”Ÿäº§æ¨¡æ‹ŸæœåŠ¡ã€‚**

å®‰è£…

```sh
npm i mockjs vite-plugin-mock
```

```javascript title="vite.config.js"
import { UserConfigExport, ConfigEnv } from 'vite'

import { viteMockServe } from 'vite-plugin-mock'
import vue from '@vitejs/plugin-vue'

export default ({ command }: ConfigEnv): UserConfigExport => {
  return {
    plugins: [
      vue(),
      viteMockServe({
        // default
        mockPath: 'mock',
        localEnabled: command === 'serve',
      }),
    ],
  }
}
```

## [vite-plugin-pages](https://github.com/hannoeru/vite-plugin-pages)

**åŸºäºæ–‡ä»¶ç³»ç»Ÿçš„åŠ¨æ€è·¯ç”±ã€‚**

å®‰è£…

```sh
npm install -D vite-plugin-pages
npm install vue-router
```

```javascript title="vite.config.js"
import Pages from 'vite-plugin-pages'

export default {
  plugins: [
    Pages({
      dirs: 'src/views',
    }),
  ],
}
```

ä¼ ç»Ÿçš„ routes å†™æ³•

```javascript
// 1. å®šä¹‰è·¯ç”±ç»„ä»¶.
const Home = { template: '<div>Home</div>' }
const About = { template: '<div>About</div>' }

// 2. å®šä¹‰ä¸€äº›è·¯ç”±
const routes = [
  { path: '/', component: Home },
  { path: '/about', component: About },
]

// 3. åˆ›å»ºè·¯ç”±å®ä¾‹å¹¶ä¼ é€’ `routes` é…ç½®
const router = VueRouter.createRouter({
  routes,
})
```

è€Œè¯¥æ’ä»¶åˆ™æ˜¯å¯¼å…¥æ•´ä¸ª pagesï¼ˆviewsï¼‰ä¸‹çš„ vue æ–‡ä»¶ä½œä¸ºè·¯ç”±ï¼Œä¹Ÿæœ‰ä¸€å¥—è‡ªå®šä¹‰çš„è·¯ç”±è§„åˆ™ï¼Œç±»ä¼¼ nuxt.js

```main.js
import { createRouter } from 'vue-router'
import routes from '~pages'

const router = createRouter({
  // ...
  routes,
})
```

## [vite-plugin-vue-layouts](https://github.com/JohnCampionJr/vite-plugin-vue-layouts)

é…åˆ`vite-plugin-pages`ä½¿ç”¨,å¯ä»¥åœ¨ç”Ÿæˆé¡µé¢è·¯ç”±çš„åŸºç¡€ä¸Šå®ç°åŠ¨æ€å¸ƒå±€åŠŸèƒ½.

å®‰è£…

```sh
npm install -D vite-plugin-vue-layouts
```

```typescript
import Vue from '@vitejs/plugin-vue'
import Pages from 'vite-plugin-pages'
import Layouts from 'vite-plugin-vue-layouts'

export default {
  plugins: [Vue(), Pages(), Layouts()],
}
```

åœ¨å¯¹åº”çš„é¡µé¢å•æ–‡ä»¶ä¸­æ·»åŠ å¸ƒå±€é…ç½®ï¼Œåœ¨è·¯ç”±æ—¶å³å¯æŒ‰é…ç½®åˆ‡æ¢å¸ƒå±€ï¼Œå°†é¡µé¢åµŒå…¥å¯¹åº”çš„å¸ƒå±€æ–‡ä»¶ä¹‹ä¸­.

```vue
<route lang="yaml">
meta:
  layout: users
</route>
```

## [vite-plugin-purge-icons](https://www.npmjs.com/package/vite-plugin-purge-icons)

**æ–¹ä¾¿çš„ä½¿ç”¨ [Iconify](https://icon-sets.iconify.design/) å›¾æ ‡ã€‚**

å®‰è£…

```sh
 pnpm add @iconify/iconify
 pnpm add vite-plugin-purge-icons @iconify/json -D
```

```javascript title="vite.config.js"
import PurgeIcons from 'vite-plugin-purge-icons'

export default {
  plugins: [
    PurgeIcons({
      /* PurgeIcons Options */
    }),
  ],
}
```

åœ¨ main.js ä¸­å¯¼å…¥ `@purge-icons/generated`

```javascript title="main.js" {3,4}
import { createApp } from 'vue'
import App from './App.vue'

import '@iconify/iconify'
import '@purge-icons/generated'

createApp(App).mount('#app')
```

ä½¿ç”¨

åœ¨ html æ–‡ä»¶ä¸­æŒ‡æ˜ class ä¸º iconifyï¼Œdata-icon ä¸º iconify å¯¹åº”çš„å›¾æ ‡ï¼ˆç›´æ¥å¤åˆ¶å®˜ç½‘çš„å›¾æ ‡ï¼‰

```html
<span class="iconify" data-icon="system-uicons:browser-alt" data-inline="false" />
```

å½“ç„¶ï¼Œä¹Ÿå¯ä»¥è‡ªè¡Œå°è£…ä¸€ä¸ª Icon ç»„ä»¶ï¼Œåƒä¸‹é¢è¿™æ ·ä½¿ç”¨ã€‚

```html
<Icon icon="ion:settings-outline" :size="30" />
```

æˆ–è€…ä½¿ç”¨ vue3 ç‰ˆçš„ [Iconify for Vue](https://docs.iconify.design/icon-components/vue/index.html) ã€‚

## [vite-plugin-windicss](https://github.com/windicss/vite-plugin-windicss)

å®‰è£…

```sh
npm i -D vite-plugin-windicss windicss
```

```javascript title="vite.config.js"
import WindiCSS from 'vite-plugin-windicss'

export default {
  plugins: [WindiCSS()],
}
```

ä¹‹æ‰€ä»¥ä½¿ç”¨ Windi CSSï¼Œä¸»è¦æ˜¯[å±æ€§åŒ–æ¨¡å¼](https://cn.windicss.org/features/attributify.html)å¤ªé¦™äº†ï¼ˆé¢„è®¡ä¼šæˆä¸ºä¸€ä¸ªè¶‹åŠ¿ï¼‰ï¼Œå±æ€§åŒ–é»˜è®¤æƒ…å†µä¸‹æ˜¯å¯é€‰çš„ï¼Œå¯ä»¥åœ¨ä½ çš„ windi é…ç½®ä¸­å¼€å¯ã€‚

```typescript title="windi.config.ts"
import { defineConfig } from 'windicss/helpers'

export default defineConfig({
  attributify: true,
})
```

å¹¶æ ¹æ®éœ€è¦è¿™æ ·ä½¿ç”¨å®ƒä»¬ï¼š

```html
<button bg="blue-400 hover:blue-500 dark:blue-500 dark:hover:blue-600" text="sm white" font="mono light" p="y-2 x-4" border="2 rounded blue-200">Button</button>
```

è¯­æ³•

```
(variant[:-]{1})*key? = "((variant:)*value)*"
```

## [vite-plugin-node](https://github.com/axe-me/vite-plugin-node)

**å…è®¸æ‚¨ä½¿ç”¨ vite ä½œä¸ºèŠ‚ç‚¹å¼€å‘æœåŠ¡å™¨ã€‚â€**

æš‚æ—¶æ²¡æœ‰å®é™…æµ‹è¯•è¿‡ï¼Œåªæ˜¯è§‰å¾—æœ‰ç‚¹æ„æ€ã€‚

## æ€»ç»“

ä½“éªŒè¿‡ä¸€æ®µæ—¶é—´çš„ Vite å¼€å‘ï¼Œå¼€å‘ä½“éªŒè¿˜æ˜¯å¾ˆæ»¡æ„çš„ï¼Œè¿™å…¶ä¸­è‚¯å®šä¸ä¸Šé¢çš„æ’ä»¶æœ‰ç€å¯†åˆ‡è”ç³»ã€‚è¿™æ¬¡å»ç¿»çœ‹äº†ä¸€äº›é¡¹ç›®ï¼Œäº†è§£å…¶ä¸­æ’ä»¶çš„ä½¿ç”¨ã€‚è¿™é‡Œåªæ˜¯æ±‡æ€»äº†äº›å¸¸ç”¨çš„ï¼Œè¿˜æœ‰æ›´å¤šç›¸å…³æ’ä»¶å¯ä»¥å»[awesome-vite](https://github.com/vitejs/awesome-vite#plugins)ä¸ŠæŸ¥çœ‹ã€‚

> å‚è€ƒæ–‡ç« :
>
> [å°¤å¤§æ¨èçš„ç¥å™¨ unplugin-vue-components,è§£æ”¾åŒæ‰‹!ä»¥åå†ä¹Ÿä¸ç”¨å‘†å‘†çš„æ‰‹åŠ¨å¼•å…¥(ç»„ä»¶,ui(Element-ui)åº“,vue hooks ç­‰) - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/7012446423367024676)
>
> [vite2 å¸¸ç”¨æ’ä»¶ç¯‡ï¼ˆä¸‰ï¼‰- è¿›é˜¶æ’ä»¶ - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/6996176490148659231)
>
> [Vite ä¹‹é«˜æ•ˆæ’ä»¶æ¨è ğŸ‰ - æ˜é‡‘ (juejin.cn)](https://juejin.cn/post/6998059092497399845)
>
> [vitejs/awesome-vite: âš¡ï¸ A curated list of awesome things related to Vite.js (github.com)](https://github.com/vitejs/awesome-vite#plugins)
